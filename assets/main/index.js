System.register("chunks:///_virtual/AudioMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(o){var i,u,e,t,n,c,r;return{setters:[function(o){i=o.createClass},function(o){u=o.cclegacy,e=o.AudioClip,t=o.resources,n=o.Node,c=o.director,r=o.AudioSource}],execute:function(){u._RF.push({},"271e2dV1W5A3ppJqkFLfA2S","AudioMgr",void 0),o("AudioMgr",function(){function o(){this._audioSource=void 0;var o=new n;o.name="__audioMgr__",c.getScene().addChild(o),c.addPersistRootNode(o),this._audioSource=o.addComponent(r)}var u=o.prototype;return u.playOneShot=function(o,i){var u=this;void 0===i&&(i=1),o instanceof e?this._audioSource.playOneShot(o,i):t.load(o,(function(o,e){o?console.log(o):u._audioSource.playOneShot(e,i)}))},u.play=function(o,i){var u=this;void 0===i&&(i=1),o instanceof e?(this._audioSource.stop(),this._audioSource.clip=o,this._audioSource.loop=!0,this._audioSource.play(),this.audioSource.volume=i):t.load(o,(function(o,e){o?console.log(o):(u._audioSource.stop(),u._audioSource.clip=e,u._audioSource.play(),u.audioSource.volume=i)}))},u.stop=function(){this._audioSource.stop()},u.pause=function(){this._audioSource.pause()},u.resume=function(){this._audioSource.play()},i(o,[{key:"audioSource",get:function(){return this._audioSource}}],[{key:"inst",get:function(){return null==this._inst&&(this._inst=new o),this._inst}}]),o}())._inst=void 0,u._RF.pop()}}}));

System.register("chunks:///_virtual/BombScroll.ts",["./rollupPluginModLoBabelHelpers.js","cc","./TileSpawn.ts","./ObjectInfo.ts","./EnumGlobal.ts","./GameManager.ts","./AudioMgr.ts"],(function(e){var t,n,o,i,r,a,l,p,u,c,s,f,d,b,h,m;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,l=e.Prefab,p=e.AudioClip,u=e.Node,c=e.instantiate,s=e.Component},function(e){f=e.TileSpawn},function(e){d=e.ObjectInfo},function(e){b=e.ObjectType},function(e){h=e.GameManager},function(e){m=e.AudioMgr}],execute:function(){var y,g,S,v,w,C,T,E,A;r._RF.push({},"62d11fwYbZAIoT9RDRy6U4b","BombScroll",void 0);var B=a.ccclass,I=a.property;e("BombScroll",(y=B("BombScroll"),g=I(f),S=I(l),v=I(p),y((T=t((C=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,o(t,"tileSpawn",T,i(t)),o(t,"expBomb3Prefab",E,i(t)),o(t,"propAudio",A,i(t)),t}n(t,e);var r=t.prototype;return r.onLoad=function(){this.node.on(u.EventType.TOUCH_END,this.onTouchEnd,this)},r.onTouchEnd=function(){if("GameOver"!=h.gameState&&"Victory"!=h.gameState){m.inst.playOneShot(this.propAudio);for(var e=0;e<this.tileSpawn.tileCols;e++)for(var t=0;t<this.tileSpawn.tileRows;t++){var n=this.tileSpawn.tilesArray[t][e];if(n.node.getComponentInChildren(d).type==b.MINE){n.setShow(),n.node.getComponentInChildren(d).node.destroy();var o=c(this.expBomb3Prefab),i=o.getComponent(d);n.objectInfo=i;var r=n.node.children.indexOf(n.node.getChildByName("Mask"));n.node.insertChild(o,r)}}this.tileSpawn.updateEmptyNumber()}},r.onDestroy=function(){this.node.off(u.EventType.TOUCH_END,this.onTouchEnd,this)},t}(s)).prototype,"tileSpawn",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(C.prototype,"expBomb3Prefab",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(C.prototype,"propAudio",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=C))||w));r._RF.pop()}}}));

System.register("chunks:///_virtual/CharacterPic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameManager.ts"],(function(t){var e,n,o,c,r,a;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,c=t.Node,r=t.Component},function(t){a=t.GameManager}],execute:function(){var i;n._RF.push({},"c6bafMY0spGMq44IvXhmcx0","CharacterPic",void 0);var s=o.ccclass;o.property,t("CharacterPic",s("CharacterPic")(i=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var o=n.prototype;return o.onLoad=function(){this.node.on(c.EventType.TOUCH_END,this.onTouchEnd,this)},o.onTouchEnd=function(){"GameOver"!=a.gameState&&"Victory"!=a.gameState&&a.instance.levelUp()},o.onDestroy=function(){this.node.off(c.EventType.TOUCH_END,this.onTouchEnd,this)},n}(r))||i);n._RF.pop()}}}));

System.register("chunks:///_virtual/EnumGlobal.ts",["cc"],(function(E){var R;return{setters:[function(E){R=E.cclegacy}],execute:function(){R._RF.push({},"b30378Av5RPnZCG8JbJHDuB","EnumGlobal",void 0);E("ObjectType",function(E){return E.UNCOVER_JEWEL="UNCOVER_JEWEL",E.EMPTY="EMPTY",E.BLOCK="BLOCK",E.TREASURE="TREASURE",E.HEALTH_SCROLL="HEALTH_SCROLL",E.UNCOVER_SCROLL="UNCOVER_SCROLL",E.RAT="RAT",E.SLIME_MAGE="SLIME_MAGE",E.BAT="BAT",E.SKELETON="SKELETON",E.HULK="HULK",E.GREEN_SLIME="GREEN_SLIME",E.SACCER="SACCER",E.SMURFS="SMURFS",E.MINOTAUR="MINOTAUR",E.DEMON_KNIGHT="DEMON_KNIGHT",E.PURPLE_SLIME="PURPLE_SLIME",E.SAVAGE="SAVAGE",E.BOMB_MAGE="BOMB_MAGE",E.FAKE_TREASURE="FAKE_TREASURE",E.DRAGON="DRAGON",E.MINE="MINE",E.EXP_TREASURE5="EXP_TREASURE5",E.EXP_BOMB3="EXP_BOMB3",E.EXP_TREASURE1="EXP_TREASURE1",E.VICTORY_CROWN="VICTORY_CROWN",E}({}));R._RF.pop()}}}));

System.register("chunks:///_virtual/ExpScroll.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameManager.ts"],(function(n){var t,o,e,c,r,i;return{setters:[function(n){t=n.inheritsLoose},function(n){o=n.cclegacy,e=n._decorator,c=n.Node,r=n.Component},function(n){i=n.GameManager}],execute:function(){var s;o._RF.push({},"3158et5NhtFVLN0yWcWnqxS","ExpScroll",void 0);var a=e.ccclass;e.property,n("ExpScroll",a("ExpScroll")(s=function(n){function o(){return n.apply(this,arguments)||this}t(o,n);var e=o.prototype;return e.onLoad=function(){this.node.on(c.EventType.TOUCH_END,this.onTouchEnd,this)},e.onTouchEnd=function(){"GameOver"!=i.gameState&&"Victory"!=i.gameState&&i.instance.modifyExp(10)},e.onDestroy=function(){this.node.off(c.EventType.TOUCH_END,this.onTouchEnd,this)},o}(r))||s);o._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioMgr.ts","./GameReadyUI.ts","./TileSpawn.ts","./GameOverUI.ts","./VictoryUI.ts","./GamingUI.ts"],(function(e){var t,i,n,r,a,o,u,l,c,s,p,h,m,g,y,d,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized,a=e.createClass},function(e){o=e.cclegacy,u=e._decorator,l=e.AudioClip,c=e.EventTarget,s=e.Label,p=e.Component},function(e){h=e.AudioMgr},function(e){m=e.GameReadyUI},function(e){g=e.TileSpawn},function(e){y=e.GameOverUI},function(e){d=e.VictoryUI},function(e){f=e.GamingUI}],execute:function(){var x,v,_,b,U,E,I,A,S,w,H,O,C,T,z,G,R,k,M,B,P,L,D,N,V,F;o._RF.push({},"79986Hb9HxL6JTdiksvA4bs","GameManager",void 0);var j=u.ccclass,J=u.property;e("GameManager",(x=j("GameManager"),v=J(m),_=J(f),b=J(y),U=J(d),E=J(g),I=J(l),A=J(l),S=J(l),w=J(l),H=J(l),O=J(l),x(((F=function(e){function t(){for(var t,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,n(t,"gameReadyUI",z,r(t)),n(t,"gamingUI",G,r(t)),n(t,"gameOverUI",R,r(t)),n(t,"victoryUI",k,r(t)),n(t,"tileSpawn",M,r(t)),t._maxHp=5,t._currentHp=5,t._maxExp=4,t._currentExp=0,t.levelUpCount=0,t.accureExp=0,t._level=1,n(t,"levelUpAudio",B,r(t)),n(t,"victoryAudio",P,r(t)),n(t,"expAudio",L,r(t)),n(t,"hurtAudio",D,r(t)),n(t,"healthAudio",N,r(t)),n(t,"gameOverAudio",V,r(t)),t}i(t,e);var o=t.prototype;return o.onLoad=function(){t._instance?this.destroy():t._instance=this},o.start=function(){console.log("游戏开始了"),this.transitionToReady()},o.transitionToReady=function(){t.gameState="Ready",this.gameReadyUI.show(),this.gamingUI.node.active=!1},o.transitionToPlay=function(){t.gameState="Play",1==t.instance.level?this.victoryUI.node.getChildByName("Button").getComponentInChildren(s).string="下一关":this.victoryUI.node.getChildByName("Button").getComponentInChildren(s).string="再杀一遍",this.gamingUI.initPoints(),this.tileSpawn.resetBoard(),this.gameReadyUI.mask(),this.gameOverUI.node.active=!1,this.victoryUI.node.active=!1,this.gamingUI.node.active=!0,this.tileSpawn.initTiles()},o.transitionToGameOver=function(){t.gameState="GameOver",h.inst.playOneShot(this.gameOverAudio),this.gameOverUI.node.active=!0,this.tileSpawn.node.children.forEach((function(e){e.getChildByName("Mask").active=!1})),this.initState()},o.transitionToVictory=function(){t.gameState="Victory",h.inst.playOneShot(this.victoryAudio),this._level=2,this.victoryUI.node.active=!0,this.tileSpawn.node.children.forEach((function(e){e.getChildByName("Mask").active=!1})),this.initState()},o.initState=function(){t._instance._currentHp=5,t._instance._maxHp=5,t._instance._currentExp=0,t._instance._maxExp=4,t._instance.levelUpCount=0,t._instance.accureExp=0},o.modifyHP=function(e){this._currentHp=Math.max(0,Math.min(this._currentHp+e,this._maxHp)),t.eventTarget.emit("hp-changed"),e<0&&h.inst.playOneShot(this.hurtAudio),e>0&&h.inst.playOneShot(this.healthAudio)},o.modifyExp=function(e,i){console.log("修改经验值"+e),i||(this.accureExp+=e,h.inst.playOneShot(this.expAudio)),this._currentExp+e>=this._maxExp?this._currentExp=this._maxExp:this._currentExp+=e,console.log("当前经验值:"+this._currentExp+"最大经验值:"+this._maxExp+"累积经验值:"+this.accureExp),t.eventTarget.emit("exp-changed")},o.levelUp=function(){this._currentExp<this._maxExp||(h.inst.playOneShot(this.levelUpAudio),console.log("升级咯"),this._maxExp<=25&&(this._maxExp+=1),this.levelUpCount+=1,this._currentExp=0,this.accureExp=this.accureExp-this._maxExp+1,this.modifyExp(this.accureExp,!0),this.levelUpCount%2==0&&this._maxHp<=15&&(this._maxHp+=1),this._currentHp=this._maxHp,t.eventTarget.emit("hp-changed"))},o.onDestroy=function(){t._instance=null},a(t,[{key:"maxHp",get:function(){return this._maxHp}},{key:"currentHp",get:function(){return this._currentHp}},{key:"maxExp",get:function(){return this._maxExp}},{key:"currentExp",get:function(){return this._currentExp}},{key:"level",get:function(){return this._level}}],[{key:"instance",get:function(){return this._instance}}]),t}(p))._instance=null,F.eventTarget=new c,F.gameState="Ready",z=t((T=F).prototype,"gameReadyUI",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(T.prototype,"gamingUI",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(T.prototype,"gameOverUI",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=t(T.prototype,"victoryUI",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(T.prototype,"tileSpawn",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=t(T.prototype,"levelUpAudio",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(T.prototype,"victoryAudio",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(T.prototype,"expAudio",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(T.prototype,"hurtAudio",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=t(T.prototype,"healthAudio",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(T.prototype,"gameOverAudio",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=T))||C));o._RF.pop()}}}));

System.register("chunks:///_virtual/GameOverUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameManager.ts"],(function(e){var t,n,r,o,a;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,r=e._decorator,o=e.Component},function(e){a=e.GameManager}],execute:function(){var c;n._RF.push({},"680e7dJRDNOZofRktHajbHd","GameOverUI",void 0);var i=r.ccclass;r.property,e("GameOverUI",i("GameOverUI")(c=function(e){function n(){return e.apply(this,arguments)||this}return t(n,e),n.prototype.onButtonClick=function(){a.instance.transitionToPlay()},n}(o))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/GameReadyUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameManager.ts","./AudioMgr.ts"],(function(e){var t,i,n,o,a,r,c,u,l,s;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){a=e.cclegacy,r=e._decorator,c=e.AudioClip,u=e.Component},function(e){l=e.GameManager},function(e){s=e.AudioMgr}],execute:function(){var p,d,y,f,h;a._RF.push({},"315c6eV2wNMlJbxIZzV3S2I","GameReadyUI",void 0);var m=r.ccclass,g=r.property;e("GameReadyUI",(p=m("GameReadyUI"),d=g(c),p((h=t((f=function(e){function t(){for(var t,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return t=e.call.apply(e,[this].concat(a))||this,n(t,"clickAudio",h,o(t)),t}i(t,e);var a=t.prototype;return a.onPlayButtonClick=function(){s.inst.playOneShot(this.clickAudio),l.instance.transitionToPlay()},a.show=function(){this.node.active=!0},a.mask=function(){this.node.active=!1},t}(u)).prototype,"clickAudio",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=f))||y));a._RF.pop()}}}));

System.register("chunks:///_virtual/GamingUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameManager.ts"],(function(t){var e,i,a,n,r,c,o,p,u;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,a=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){r=t.cclegacy,c=t._decorator,o=t.Node,p=t.Component},function(t){u=t.GameManager}],execute:function(){var h,l,s,d,g,v,f;r._RF.push({},"dce5266WwNK/JY1+NttQAll","GamingUI",void 0);var m=c.ccclass,x=c.property;t("GamingUI",(h=m("GamingUI"),l=x(o),s=x(o),h((v=e((g=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),c=0;c<i;c++)r[c]=arguments[c];return e=t.call.apply(t,[this].concat(r))||this,a(e,"hpBar",v,n(e)),a(e,"expBar",f,n(e)),e.hpPoints=[],e.expPoints=[],e}i(e,t);var r=e.prototype;return r.start=function(){u.eventTarget.on("hp-changed",this.updateHP,this),u.eventTarget.on("exp-changed",this.updateExp,this)},r.initPoints=function(){this.hpPoints=this.hpBar.children,this.expPoints=this.expBar.children,this.updateHP(),this.updateExp()},r.updateHP=function(){var t=u.instance;this.hpPoints.forEach((function(e,i){i>=t.maxHp&&(e.active=!1),i<t.currentHp&&(e.active=!0,e.getChildByName("Fill").active=!0,e.getChildByName("Background").active=!1),i>=t.currentHp&&i<t.maxHp&&(e.active=!0,e.getChildByName("Fill").active=!1,e.getChildByName("Background").active=!0)}))},r.updateExp=function(){var t=u.instance;this.expPoints.forEach((function(e,i){i>=t.maxExp&&(e.active=!1),i<t.currentExp&&(e.active=!0,e.getChildByName("Fill").active=!0,e.getChildByName("Background").active=!1),i>=t.currentExp&&i<t.maxExp&&(e.active=!0,e.getChildByName("Fill").active=!1,e.getChildByName("Background").active=!0)}))},r.onDestroy=function(){u.eventTarget.off("hp-changed",this.updateHP,this),u.eventTarget.off("exp-changed",this.updateExp,this)},e}(p)).prototype,"hpBar",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=e(g.prototype,"expBar",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=g))||d));r._RF.pop()}}}));

System.register("chunks:///_virtual/HealthScroll.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameManager.ts","./TileSpawn.ts"],(function(e){var n,t,o,i,r,a,c,l,s,u;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,c=e.Node,l=e.Component},function(e){s=e.GameManager},function(e){u=e.TileSpawn}],execute:function(){var p,f,h,y,d;r._RF.push({},"a18c7TD5fpFYLZ24LUSI7qg","HealthScroll",void 0);var S=a.ccclass,v=a.property;e("HealthScroll",(p=S("HealthScroll"),f=v(u),p((d=n((y=function(e){function n(){for(var n,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return n=e.call.apply(e,[this].concat(r))||this,o(n,"tileSpawn",d,i(n)),n}t(n,e);var r=n.prototype;return r.onLoad=function(){this.node.on(c.EventType.TOUCH_END,this.onTouchEnd,this)},r.onTouchEnd=function(){if("GameOver"!=s.gameState&&"Victory"!=s.gameState){var e=s.instance.currentHp,n=s.instance.maxHp;s.instance.modifyHP(n-e)}},r.onDestroy=function(){this.node.off(c.EventType.TOUCH_END,this.onTouchEnd,this)},n}(l)).prototype,"tileSpawn",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=y))||h));r._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./AudioMgr.ts","./EnumGlobal.ts","./GameManager.ts","./ObjectInfo.ts","./ObjectManager.ts","./Tile.ts","./TileSpawn.ts","./CharacterPic.ts","./GameOverUI.ts","./GameReadyUI.ts","./GamingUI.ts","./PlayerUI.ts","./PopPage.ts","./BombScroll.ts","./ExpScroll.ts","./HealthScroll.ts","./RatScroll.ts","./VictoryUI.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/ObjectInfo.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EnumGlobal.ts"],(function(t){var e,i,r,n,o,p,a,c,l;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,r=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){o=t.cclegacy,p=t._decorator,a=t.Enum,c=t.Component},function(t){l=t.ObjectType}],execute:function(){var u,s,y,b,f,h,m,E,O,L,d;o._RF.push({},"65f35zSdxpNLp+USp4IayKt","ObjectInfo",void 0);var g=p.ccclass,R=p.property;t("ObjectInfo",(u=g("ObjectInfo"),s=R({type:a(l),tooltip:"对象类型"}),y=R({type:Number,tooltip:"对象攻击力"}),b=R({type:Boolean,tooltip:"是否被击败"}),f=R({type:Number,tooltip:"砖块血量"}),u((E=e((m=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),p=0;p<i;p++)o[p]=arguments[p];return e=t.call.apply(t,[this].concat(o))||this,r(e,"type",E,n(e)),r(e,"attack",O,n(e)),r(e,"isDead",L,n(e)),r(e,"blockHp",d,n(e)),e}return i(e,t),e.prototype.isMonster=function(){return this.type!==l.EMPTY&&this.type!==l.GEOGRE&&this.type!==l.BLOCK&&this.type!==l.TREASURE&&this.type!==l.HEALTH_SCROLL&&this.type!==l.UNCOVER_SCROLL},e}(c)).prototype,"type",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return l.EMPTY}}),O=e(m.prototype,"attack",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),L=e(m.prototype,"isDead",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=e(m.prototype,"blockHp",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),h=m))||h));o._RF.pop()}}}));

System.register("chunks:///_virtual/ObjectManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,i,s,o,e;return{setters:[function(t){n=t.inheritsLoose,i=t.createClass},function(t){s=t.cclegacy,o=t._decorator,e=t.Component}],execute:function(){var E,c;s._RF.push({},"02536kRCm1M34+itswIMjln","ObjectManager",void 0);var u=o.ccclass;o.property,t("ObjectManager",u("ObjectManager")(((c=function(t){function s(){for(var n,i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(n=t.call.apply(t,[this].concat(s))||this).initialCounts1=void 0,n.initialCounts2=void 0,n.counts1={UNCOVER_JEWEL:1,EMPTY:28,BLOCK:2,TREASURE:2,HEALTH_SCROLL:2,UNCOVER_SCROLL:0,RAT:6,SLIME_MAGE:0,BAT:5,SKELETON:2,HULK:1,GREEN_SLIME:1,SACCER:1,SMURFS:0,MINOTAUR:0,DEMON_KNIGHT:0,PURPLE_SLIME:0,SAVAGE:0,BOMB_MAGE:0,FAKE_TREASURE:0,DRAGON:1,MINE:5},n.counts2={UNCOVER_JEWEL:1,EMPTY:28,BLOCK:6,TREASURE:5,GEOGRE:0,HEALTH_SCROLL:5,UNCOVER_SCROLL:1,RAT:13,SLIME_MAGE:0,BAT:12,SKELETON:10,HULK:8,GREEN_SLIME:8,SACCER:2,SMURFS:0,MINOTAUR:5,DEMON_KNIGHT:4,PURPLE_SLIME:5,SAVAGE:2,BOMB_MAGE:1,FAKE_TREASURE:2,DRAGON:1,MINE:10},n}n(s,t);var o=s.prototype;return o.onLoad=function(){s._instance=this,this.initialCounts1=JSON.parse(JSON.stringify(this.counts1)),this.initialCounts2=JSON.parse(JSON.stringify(this.counts2))},o.resetAllCounts=function(){this.counts1=JSON.parse(JSON.stringify(this.initialCounts1)),this.counts2=JSON.parse(JSON.stringify(this.initialCounts2))},o.getCount=function(t,n){return 1==n?this.counts1[t]:this.counts2[t]},o.decreaseCount=function(t,n){1==n?this.counts1[t]>0&&(this.counts1[t]-=1):this.counts2[t]>0&&(this.counts2[t]-=1)},o.onDestroy=function(){s._instance=null},i(s,null,[{key:"instance",get:function(){return this._instance}}]),s}(e))._instance=null,E=c))||E);s._RF.pop()}}}));

System.register("chunks:///_virtual/PlayerUI.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,r,n,c;return{setters:[function(t){e=t.inheritsLoose},function(t){r=t.cclegacy,n=t._decorator,c=t.Component}],execute:function(){var o;r._RF.push({},"f989e5gHcJMA4ctBcGFekCk","PlayerUI",void 0);var s=n.ccclass;n.property,t("PlayerUI",s("PlayerUI")(o=function(t){function r(){return t.apply(this,arguments)||this}return e(r,t),r.prototype.start=function(){},r}(c))||o);r._RF.pop()}}}));

System.register("chunks:///_virtual/PopPage.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,t,n,i,o,a,c;return{setters:[function(e){r=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,c=e.Component}],execute:function(){var l,p,u,s,f;o._RF.push({},"bafe9nKnaZAQJL1p6ofd0I6","PopPage",void 0);var g=a.ccclass,P=a.property;e("PopPage",(l=g("PopPage"),p=P(String),l((f=r((s=function(e){function r(){for(var r,t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return r=e.call.apply(e,[this].concat(o))||this,n(r,"value",f,i(r)),r}return t(r,e),r}(c)).prototype,"value",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),u=s))||u));o._RF.pop()}}}));

System.register("chunks:///_virtual/RatScroll.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ObjectInfo.ts","./TileSpawn.ts","./EnumGlobal.ts","./GameManager.ts","./AudioMgr.ts"],(function(t){var e,n,o,i,r,a,l,c,u,p,s,f,h,d;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,l=t.AudioClip,c=t.Node,u=t.Component},function(t){p=t.ObjectInfo},function(t){s=t.TileSpawn},function(t){f=t.ObjectType},function(t){h=t.GameManager},function(t){d=t.AudioMgr}],execute:function(){var y,S,g,v,b,w,T;r._RF.push({},"7a641eDhXhMRr5eAb6kGI81","RatScroll",void 0);var m=a.ccclass,A=a.property;t("RatScroll",(y=m("RatScroll"),S=A(s),g=A(l),y((w=e((b=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,o(e,"tileSpawn",w,i(e)),o(e,"propAudio",T,i(e)),e}n(e,t);var r=e.prototype;return r.onLoad=function(){this.node.on(c.EventType.TOUCH_END,this.onTouchEnd,this)},r.onTouchEnd=function(){if("GameOver"!=h.gameState&&"Victory"!=h.gameState){d.inst.playOneShot(this.propAudio);for(var t=0;t<this.tileSpawn.tileRows;t++)for(var e=0;e<this.tileSpawn.tileCols;e++){var n=this.tileSpawn.tilesArray[t][e];n.node.getComponentInChildren(p).type==f.RAT&&n.setShow()}}},r.onDestroy=function(){this.node.off(c.EventType.TOUCH_END,this.onTouchEnd,this)},e}(u)).prototype,"tileSpawn",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(b.prototype,"propAudio",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=b))||v));r._RF.pop()}}}));

System.register("chunks:///_virtual/Tile.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EnumGlobal.ts","./ObjectInfo.ts","./TileSpawn.ts","./GameManager.ts","./AudioMgr.ts"],(function(e){var t,n,o,i,r,s,a,h,l,d,c,u,f,p,b,g,v,C,y,m,M;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized,r=e.createForOfIteratorHelperLoose,s=e.createClass},function(e){a=e.cclegacy,h=e._decorator,l=e.Label,d=e.Prefab,c=e.AudioClip,u=e.Node,f=e.EventMouse,p=e.Vec3,b=e.instantiate,g=e.Component},function(e){v=e.ObjectType},function(e){C=e.ObjectInfo},function(e){y=e.TileSpawn},function(e){m=e.GameManager},function(e){M=e.AudioMgr}],execute:function(){var I,T,E,P,j,S,w,L,A,O,k,R,x,N,B,_,H,U,G,V,Y;a._RF.push({},"c7b7eSHtdhC6K+ZFQvZGZNt","Tile",void 0);var z=h.ccclass,X=h.property;e("Tile",(I=z("Tile"),T=X(l),E=X(d),P=X(d),j=X(d),S=X(d),w=X(d),L=X(d),A=X(l),O=X(c),I((x=t((R=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t=e.call.apply(e,[this].concat(r))||this,o(t,"testPositionLabel",x,i(t)),o(t,"healthScrollPrefab",N,i(t)),o(t,"expTreasure5Prefab",B,i(t)),o(t,"expBomb3Prefab",_,i(t)),o(t,"expTreasure1Prefab",H,i(t)),o(t,"victoryCrownPrefab",U,i(t)),o(t,"fakeTreasurePrefab",G,i(t)),o(t,"valueLabel",V,i(t)),o(t,"clickAudio",Y,i(t)),t.gridX=0,t.gridY=0,t.isMask=!0,t.attackValue=0,t.objectType=v.EMPTY,t.objectInfo=null,t}n(t,e);var a=t.prototype;return a.onLoad=function(){this.node.on(u.EventType.MOUSE_DOWN,this.onTouchEnd,this)},a.setGridPosition=function(e,t){this.gridX=e,this.gridY=t},a.showTestPositionLabel=function(e,t){this.gridX=e,this.gridY=t,this.testPositionLabel.string=e+","+t},a.onTouchEnd=function(e){if("GameOver"!=m.gameState&&"Victory"!=m.gameState)if(e.getButton()!==f.BUTTON_RIGHT){if(e.getButton()===f.BUTTON_LEFT){if(this.isMask&&(M.inst.playOneShot(this.clickAudio),this.setShow(),"HEALTH_SCROLL"==this.objectInfo.type||"UNCOVER_SCROLL"==this.objectInfo.type||"TREASURE"==this.objectInfo.type||"FAKE_TREASURE"==this.objectInfo.type||"EXP_BOMB3"==this.objectInfo.type||"BLOCK"==this.objectInfo.type))return;if(this.objectInfo){if("EMPTY"==this.objectInfo.type)return;if(this.objectInfo.isDead){switch(this.objectInfo.type){case"BOMB_MAGE":this.bombMageMethod();break;case"SLIME_MAGE":this.slimeMageMethod();break;case"SMURFS":this.smurfsMethod()}return this.node.getComponentInChildren(C).node.active=!1,m.instance.modifyExp(this.objectInfo.attack),"SAVAGE"==this.objectInfo.type?void this.savageMethod():"DRAGON"==this.objectInfo.type?void this.dragonMethod():(this.node.getComponentInChildren(C).type=v.EMPTY,void this.node.parent.getComponent(y).updateEmptyNumber())}if("UNCOVER_JEWEL"==this.objectInfo.type)return void this.uncoverJewelMethod();if("UNCOVER_SCROLL"==this.objectInfo.type)return void this.uncoverScrollMethod();if("HEALTH_SCROLL"==this.objectInfo.type)return void this.healthScrollMethod();if("TREASURE"==this.objectInfo.type)return void this.treasureMethod();if("EXP_TREASURE5"==this.objectInfo.type)return void this.expValueMethod(5);if("EXP_BOMB3"==this.objectInfo.type)return void this.expValueMethod(3);if("BLOCK"==this.objectInfo.type)return void this.blockMethod();if("EXP_TREASURE1"==this.objectInfo.type)return void this.expValueMethod(1);if("VICTORY_CROWN"==this.objectInfo.type)return console.log("游戏胜利！"),void m.instance.transitionToVictory();if(this.objectInfo.isMonster())return void this.otherMonsterMethod()}}}else{if(!this.isMask)return;var t=this.node.getPosition(),n=t.x+180,o=t.y;t.x>0&&(n=t.x-180),t.y+150>=390&&(o=265),t.y-150<=-330&&(o=-205);var i=new p(n,o,0);this.node.parent.getComponent(y).showPage(e,i,this.node)}},a.setText=function(e){this.valueLabel&&(this.valueLabel.string=e,this.valueLabel.node.active=!0)},a.cancelSetText=function(){this.valueLabel&&(this.valueLabel.string="",this.valueLabel.node.active=!1)},a.setObject=function(e){this.objectType=e,this.objectInfo=this.node.getComponentInChildren(C)},a.setShow=function(){this.node.getChildByName("Mask").active=!1,this.isMask=!1;this.node.getChildByName("ValueLabel");this.valueLabel&&(this.valueLabel.string="",this.valueLabel.node.active=!1)},a.dragonMethod=function(){this.node.getComponentInChildren(C).node.active=!1,this.node.getComponentInChildren(C).destroy();var e=b(this.victoryCrownPrefab),t=e.getComponent(C);this.objectInfo=t;var n=this.node.children.indexOf(this.node.getChildByName("Mask"));this.node.insertChild(e,n)},a.uncoverJewelMethod=function(){this.node.getChildByName("UncoverJewel").active=!1,1==m.instance.level?this.showAroundTile():this.showCrossTile()},a.bombMageMethod=function(){for(var e=this.node.parent.getComponent(y),t=0;t<e.tileCols;t++)for(var n=0;n<e.tileRows;n++){var o=e.tilesArray[n][t];if(o.node.getComponentInChildren(C).type==v.MINE){o.node.getComponentInChildren(C).node.active=!1,o.node.getComponentInChildren(C).destroy();var i=b(this.expBomb3Prefab),r=i.getComponent(C);o.objectInfo=r;var s=o.node.children.indexOf(o.node.getChildByName("Mask"));o.node.insertChild(i,s)}}e.updateEmptyNumber()},a.slimeMageMethod=function(){this.showAllType(v.PURPLE_SLIME),this.showAllType(v.GREEN_SLIME)},a.smurfsMethod=function(){this.showAllType(v.RAT)},a.uncoverScrollMethod=function(){for(var e,t=null==(e=this.node.parent)?void 0:e.getComponent(y),n=Math.floor(Math.random()*(t.tileCols-2)),o=Math.floor(Math.random()*(t.tileRows-1)),i=0;i<=2;i++)for(var r=0;r<=1;r++){var s=n+i,a=o+r;t.tilesArray[a][s].setShow()}this.node.getChildByName("UncoverScroll").active=!1,this.node.getComponentInChildren(C).type=v.EMPTY,t.updateEmptyNumber()},a.healthScrollMethod=function(){var e=m.instance.currentHp,t=m.instance.maxHp;m.instance.modifyHP(t-e),this.node.getComponentInChildren(C).node.active=!1,this.node.getComponentInChildren(C).type=v.EMPTY,this.node.parent.getComponent(y).updateEmptyNumber()},a.expValueMethod=function(e){m.instance.modifyExp(e),this.node.getComponentInChildren(C).node.active=!1,this.node.getComponentInChildren(C).type=v.EMPTY,this.node.parent.getComponent(y).updateEmptyNumber()},a.savageMethod=function(){this.node.getComponentInChildren(C).destroy();var e=b(this.healthScrollPrefab),t=e.getComponent(C);this.objectInfo=t;var n=this.node.children.indexOf(this.node.getChildByName("Mask"));this.node.insertChild(e,n)},a.treasureMethod=function(){this.node.getComponentInChildren(C).node.active=!1,this.node.getComponentInChildren(C).destroy();var e=b(this.expTreasure5Prefab),t=e.getComponent(C);this.objectInfo=t;var n=this.node.children.indexOf(this.node.getChildByName("Mask"));this.node.insertChild(e,n)},a.blockMethod=function(){if(!(m.instance.currentHp<=0)){var e=this.node.getComponentInChildren(C).blockHp-1;if(this.node.getComponentInChildren(C).blockHp=e,m.instance.modifyHP(-1),e<=0){this.node.getComponentInChildren(C).node.active=!1,this.node.getComponentInChildren(C).destroy();var t=b(this.expTreasure1Prefab),n=t.getComponent(C);this.objectInfo=n;var o=this.node.children.indexOf(this.node.getChildByName("Mask"));this.node.insertChild(t,o)}}},a.fakeTreasureMethod=function(){var e=b(this.fakeTreasurePrefab),t=e.getComponent(C);this.objectInfo=t;var n=this.node.children.indexOf(this.node.getChildByName("Mask"));this.node.insertChild(e,n),this.node.getComponentInChildren(C).node.destroy()},a.otherMonsterMethod=function(){"FAKE_TREASURE"==this.objectInfo.type&&this.fakeTreasureMethod();var e,t=this.objectInfo.attack;m.instance.currentHp>=t?(m.instance.modifyHP(-t),this.objectInfo.isDead=!0,this.objectInfo.type==v.SACCER&&(null==(e=this.node.parent)?void 0:e.getComponent(y)).cancelSaccerMask(this.gridY,this.gridX)):(console.log("Game Over!"),m.instance.transitionToGameOver())},a.showAllType=function(e){for(var t,n=null==(t=this.node.parent)?void 0:t.getComponent(y),o=0;o<n.tileRows;o++)for(var i=0;i<n.tileCols;i++){var r=n.tilesArray[o][i];r.node.getComponentInChildren(C).type==e&&r.setShow()}},a.showCrossTile=function(){for(var e,t=null==(e=this.node.parent)?void 0:e.getComponent(y),n=0,o=[2,1,0,-1,-2];n<o.length;n++){var i=o[n],s=this.gridY+i,a=void 0;switch(Math.abs(i)){case 2:a=[0];break;case 1:a=[-1,0,1];break;default:a=[-2,-1,0,1,2]}for(var h,l=r(a);!(h=l()).done;){var d=h.value;t.tilesArray[this.gridX+d][s].setShow()}}},a.showAroundTile=function(){for(var e,t=null==(e=this.node.parent)?void 0:e.getComponent(y),n=0,o=[1,0,-1];n<o.length;n++)for(var i=o[n],r=0,s=[1,0,-1];r<s.length;r++){var a=s[r];t.tilesArray[this.gridX+i][this.gridY+a].setShow()}},a.onDestroy=function(){this.node.off(u.EventType.TOUCH_END,this.onTouchEnd,this)},s(t,[{key:"gridPosition",get:function(){return{x:this.gridX,y:this.gridY}}}]),t}(g)).prototype,"testPositionLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=t(R.prototype,"healthScrollPrefab",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=t(R.prototype,"expTreasure5Prefab",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(R.prototype,"expBomb3Prefab",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(R.prototype,"expTreasure1Prefab",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(R.prototype,"victoryCrownPrefab",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(R.prototype,"fakeTreasurePrefab",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(R.prototype,"valueLabel",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(R.prototype,"clickAudio",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=R))||k));a._RF.pop()}}}));

System.register("chunks:///_virtual/TileSpawn.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Tile.ts","./EnumGlobal.ts","./ObjectInfo.ts","./ObjectManager.ts","./PopPage.ts","./GameManager.ts"],(function(t){var i,e,n,o,a,s,r,c,l,h,f,p,u,d,y,g,v,b,m;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized,a=t.createForOfIteratorHelperLoose},function(t){s=t.cclegacy,r=t._decorator,c=t.Prefab,l=t.instantiate,h=t.Node,f=t.EventMouse,p=t.Label,u=t.Component},function(t){d=t.Tile},function(t){y=t.ObjectType},function(t){g=t.ObjectInfo},function(t){v=t.ObjectManager},function(t){b=t.PopPage},function(t){m=t.GameManager}],execute:function(){var E,P,M,O,A,C,j,R,x,S,T;s._RF.push({},"eb48bxYXvpJs7dXH4PHT6md","TileSpawn",void 0);var w=r.ccclass,I=r.property;t("TileSpawn",(E=w("TileSpawn"),P=I(c),M=I(Number),O=I([c]),A=I(c),E((R=i((j=function(t){function i(){for(var i,e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];return i=t.call.apply(t,[this].concat(a))||this,n(i,"tilePrefab",R,o(i)),n(i,"tileSize",x,o(i)),n(i,"objectPrefabs",S,o(i)),n(i,"popPagePrefab",T,o(i)),i.gameHeight=1280,i.gameWidth=720,i.tileRows=void 0,i.tileCols=void 0,i.standardX=void 0,i.tilesArray=[],i.initialArray=[],i.initPointPosition=null,i.objectMap=new Map,i.existObjectArray=[],i.saccerPosArray=[],i.allInitialObjectArray=[{type:y.RAT,weight:5},{type:y.BAT,weight:5},{type:y.SKELETON,weight:2},{type:y.HULK,weight:1},{type:y.GREEN_SLIME,weight:1},{type:y.EMPTY,weight:40},{type:y.BLOCK,weight:1},{type:y.MINOTAUR,weight:1},{type:y.DEMON_KNIGHT,weight:1},{type:y.SAVAGE,weight:1}],i.popPageInstance=null,i.currentTiles=[],i.level=void 0,i}e(i,t);var s=i.prototype;return s.initTiles=function(){this.level=m.instance.level,1==m.instance.level?(this.tileRows=7,this.tileCols=7,this.standardX=this.gameWidth/this.tileCols):(this.tileRows=10,this.tileCols=13,this.standardX=this.gameWidth/this.tileCols),this.generateEmptyBoard(),this.initializeObjectMap(),this.gengrateAllObject(),this.placeEmpty(),this.updateEmptyNumber(),this.setSaccerMask(),this.showObjectCount()},s.resetBoard=function(){console.log("销毁所有现有tile"),this.node.children.forEach((function(t){t.destroy()})),this.currentTiles=[],this.initialArray=[],this.tilesArray=[],this.initPointPosition=null,this.existObjectArray=[],this.saccerPosArray=[],v.instance.resetAllCounts()},s.showObjectCount=function(){var t={};this.tilesArray.forEach((function(i){i.forEach((function(i){var e=i.objectType;t[e]?t[e]++:t[e]=1}))})),console.log(t)},s.showPage=function(t,i,e){var n=this;if(this.popPageInstance)return this.popPageInstance.destroy(),void(this.popPageInstance=null);this.popPageInstance=l(this.popPagePrefab),this.node.addChild(this.popPageInstance),this.popPageInstance.setPosition(i),this.popPageInstance.children.forEach((function(t,i){t.on(h.EventType.MOUSE_DOWN,(function(i){if(i.getButton()===f.BUTTON_LEFT){var o=t.getComponent(b).value;n.onPopTileClick(o,e)}}))}))},s.onPopTileClick=function(t,i){var e=i.getComponent(d);e&&("Cancel"==t?e.cancelSetText():e.setText(t.toString())),this.popPageInstance&&(this.popPageInstance.destroy(),this.popPageInstance=null)},s.revealAllObject=function(){this.node.children.forEach((function(t){t.getComponent(d).setShow()}))},s.initializeObjectMap=function(){var t=this;this.objectPrefabs.forEach((function(i){var e=l(i).getComponent(g);e&&t.objectMap.set(e.type,i)}))},s.generateEmptyBoard=function(){for(var t=-(this.gameWidth-this.tileSize-(this.standardX-this.tileSize))/2,i=this.tileRows*this.tileSize/2,e=0;e<this.tileRows;e++){this.tilesArray[e]=[];for(var n=0;n<this.tileCols;n++){var o=l(this.tilePrefab),a=o.getComponent(d);o.setPosition(t+n*this.standardX,i-e*this.tileSize),a.setGridPosition(e,n),this.tilesArray[e][n]=a,this.node.addChild(o)}}},s.gengrateAllObject=function(){this.placeDragon(),1!==this.level&&this.placeSlimeMage(),this.placeUncoverJewel(),this.placeInititalMonster(),this.placeWildmen(),this.placeBlocks(),this.placeRandomObjects(y.MINE),this.placeRandomObjects(y.TREASURE),this.placeRandomObjects(y.HEALTH_SCROLL),this.placeRandomObjects(y.UNCOVER_SCROLL),this.placeRandomObjects(y.RAT),this.placeRandomObjects(y.BAT),this.placeRandomObjects(y.SKELETON),this.placeRandomObjects(y.HULK),this.placeRandomObjects(y.GREEN_SLIME),this.placeRandomObjects(y.SACCER),this.placeRandomObjects(y.SMURFS),this.placeRandomObjects(y.MINOTAUR),this.placeRandomObjects(y.DEMON_KNIGHT),this.placeRandomObjects(y.FAKE_TREASURE)},s.placeDragon=function(){var t=Math.floor(this.tileCols/2),i=Math.floor(this.tileRows/2),e=t-Math.floor(2*Math.random());this.placeObject(e,i,y.DRAGON),this.existObjectArray.push([e,i])},s.placeSlimeMage=function(){var t=this,i=this.getEdgeTiles();if(0===i.length)throw new Error("无边缘点可用！");var e=Math.floor(Math.random()*i.length),n=i[e].x,o=i[e].y,a=this.checkSurroundingSlots(n,o,1);if(a[0])return this.placeObject(n,o,y.SLIME_MAGE),this.existObjectArray.push([n,o]),void a[1].forEach((function(i){t.placeObject(i.nx,i.ny,y.PURPLE_SLIME),t.existObjectArray.push([i.nx,i.ny])}))},s.placeUncoverJewel=function(){this.initPointPosition=this.findInitialPoint(),this.placeObject(this.initPointPosition.cx,this.initPointPosition.cy,y.UNCOVER_JEWEL),1==m.instance.level?this.initialArray=this.findAroundRange(this.initPointPosition.cx,this.initPointPosition.cy):this.initialArray=this.findCrossStepRange(this.initPointPosition.cx,this.initPointPosition.cy)},s.placeInititalMonster=function(){for(var t=this,i=[y.RAT,y.BAT,y.SKELETON,y.HULK,y.GREEN_SLIME],e=this.initialArray.slice(),n=e.length-1;n>0;n--){var o=Math.floor(Math.random()*(n+1)),a=[e[o],e[n]];e[n]=a[0],e[o]=a[1]}var s=e.findIndex((function(i){return i.cx===t.initPointPosition.cx&&i.cy===t.initPointPosition.cy}));e.splice(s,1);for(var r=0;r<e.length;){var c=e[r];if(this.isPositionEmpty(c.cx,c.cy))if(r<3){var l=i[Math.floor(Math.random()*i.length)];this.placeObject(c.cx,c.cy,l),r++}else if(3!==r){if(r>3){var h=this.getRandomObjectTypeWithWeight();if(h==y.EMPTY){r++;continue}if(v.instance.getCount(h,this.level)<=0)continue;if(h==y.SAVAGE)continue;if(h==y.BLOCK){var f=[];if(this.isPositionEmpty(c.cx-1,c.cy)&&f.push([c.cx-1,c.cy]),this.isPositionEmpty(c.cx+1,c.cy)&&f.push([c.cx+1,c.cy]),this.isPositionEmpty(c.cx,c.cy-1)&&f.push([c.cx,c.cy-1]),this.isPositionEmpty(c.cx,c.cy+1)&&f.push([c.cx,c.cy+1]),f.length>=1){var p=f[Math.floor(Math.random()*f.length)];this.placeObject(c.cx,c.cy,h),this.placeObject(p[0],p[1],h),r++;continue}continue}this.placeObject(c.cx,c.cy,h),r++}}else this.placeObject(c.cx,c.cy,y.HEALTH_SCROLL),r++;else r++}},s.placeWildmen=function(t){var i=this;if(!(v.instance.getCount(y.SAVAGE,this.level)<=0)){var e=[];if(1==v.instance.getCount(y.SAVAGE,this.level)){for(var n=function(n){i.isPositionEmpty(n,t.cy)&&!i.initialArray.some((function(i){return i.cx===n&&i.cy===t.cy}))&&e.push({x:n,y:t.cy})},o=0;o<this.tileCols;o++)n(o);if(e.length>=1){for(var a=Math.floor(Math.random()*e.length),s=0;Math.abs(e[a].x-t.cx)<=4&&s<10;)a=Math.floor(Math.random()*e.length),s++;this.placeObject(e[a].x,t.cy,y.SAVAGE)}}if(2==v.instance.getCount(y.SAVAGE,this.level))for(var r=0;r<this.tileRows;r++){for(var c=Math.floor(Math.random()*this.tileRows),l=0;l<this.tileCols;l++)this.isPositionEmpty(l,c)&&e.push({x:l,y:c});if(e.length>=2){for(var h=Math.floor(Math.random()*e.length),f=Math.floor(Math.random()*e.length),p=0;Math.abs(e[h].x-e[f].x)<=4&&p<10;)h=Math.floor(Math.random()*e.length),f=Math.floor(Math.random()*e.length),p++;return this.placeObject(e[h].x,e[h].y,y.SAVAGE),void this.placeObject(e[f].x,e[f].y,y.SAVAGE)}}}},s.placeBlocks=function(){for(var t=[{dx:1,dy:0},{dx:0,dy:1}],i=v.instance.getCount(y.BLOCK,this.level)/2,e=0;e<i;){var n=Math.floor(Math.random()*(this.tileCols-1)),o=Math.floor(Math.random()*(this.tileRows-1)),a=t[Math.floor(2*Math.random())];this.isPositionEmpty(n,o)&&this.isPositionEmpty(n+a.dx,o+a.dy)&&(this.placeObject(n,o,y.BLOCK),this.placeObject(n+a.dx,o+a.dy,y.BLOCK),e++)}},s.placeEmpty=function(){var t=this;this.node.children.forEach((function(i){if(!i.getComponentInChildren(g)){var e=t.getTilePosition(i);if(!e)return;t.placeObject(e.x,e.y,y.EMPTY)}}))},s.updateEmptyNumber=function(){var t=this;this.node.children.forEach((function(i){var e,n=i.getComponentInChildren(g),o=null==(e=i.getChildByName("TestLabel"))?void 0:e.getComponent(p);if(o)if(n.type==y.EMPTY||y.UNCOVER_JEWEL){var a=t.getTilePosition(i);if(!a)return;var s=t.sumSurroundAttack(a.x,a.y);o.string=0==s?"":s.toString()}else o.string="";else console.log("没有testLabel")}))},s.placeObject=function(t,i,e){var n=this.tilesArray[i][t];return!(!n||n.objectType!==y.EMPTY)&&(this.instantiateObject(t,i,e),n.setObject(e),v.instance.decreaseCount(e,this.level),n.testPositionLabel.string="",!0)},s.findInitialPoint=function(){for(var t=this,i=[],e=m.instance.level,n=e;n<this.tileCols-e;n++)for(var o=function(){var e=t.findAroundRange(n,a);if(t.existObjectArray.some((function(t){return e.some((function(i){return i.cx===t[0]&&i.cy===t[1]}))})))return 1;i.push({cx:n,cy:a})},a=e;a<this.tileRows-e;a++)o();return i[Math.floor(Math.random()*i.length)]},s.getRandomObjectTypeWithWeight=function(){for(var t,i=this.allInitialObjectArray.reduce((function(t,i){return t+i.weight}),0),e=Math.random()*i,n=0,o=a(this.allInitialObjectArray);!(t=o()).done;){var s=t.value;if(e<=(n+=s.weight))return s.type}return this.allInitialObjectArray[Math.floor[Math.random()*this.allInitialObjectArray.length]].type},s.placeRandomObjects=function(t){for(var i=this,e=0,n=v.instance.getCount(t,this.level),o=100*n,a=0,s=function(){var n=Math.floor(Math.random()*i.tileCols),o=Math.floor(Math.random()*i.tileRows);if(i.initialArray.some((function(t){return t.cx===n&&t.cy===o})))return a++,1;i.isPositionEmpty(n,o)&&(i.placeObject(n,o,t),t==y.SACCER&&i.saccerPosArray.push([n,o]),t==y.FAKE_TREASURE&&console.log([n,o]),e++),a++};e<n&&a<o;)s();e<n&&console.warn("Failed to place all objects ("+e+"/"+n+")")},s.setSaccerMask=function(){var t=this;this.saccerPosArray.forEach((function(i){var e=i[0],n=i[1];t.findCrossStepRange(e,n).forEach((function(i){if(t.isValidPosition(i.cx,i.cy)&&(i.cx!=e||i.cy!=n)){var o=t.tilesArray[i.cy][i.cx],a=o.node.getComponent(g);a&&a.type==y.SACCER||(o.node.getChildByName("SaccerMask").active=!0)}}))}))},s.cancelSaccerMask=function(t,i){var e=this;this.findCrossStepRange(t,i).forEach((function(n){e.isValidPosition(n.cx,n.cy)&&(n.cx==t&&n.cy==i||(e.tilesArray[n.cy][n.cx].node.getChildByName("SaccerMask").active=!1))}))},s.getEdgeTiles=function(){for(var t=[],i=0;i<this.tileRows;i++)for(var e=0;e<this.tileCols;e++)0===e&&0===i||e===this.tileCols-1&&0===i||0===e&&i===this.tileRows-1||e===this.tileCols-1&&i===this.tileRows-1||0!==e&&e!==this.tileCols-1&&0!==i&&i!==this.tileRows-1||t.push({x:e,y:i});return t},s.checkSurroundingSlots=function(t,i,e){for(var n=[],o=!1,a=0,s=-e;s<=e;s++)for(var r=-e;r<=e;r++)if(0!==s||0!==r){var c=t+s,l=i+r;this.isPositionEmpty(c,l)&&(n.push({nx:c,ny:l}),a++)}return a>=5&&(o=!0),[o,n]},s.findCrossStepRange=function(t,i){for(var e=[],n=0,o=[2,1,0,-1,-2];n<o.length;n++){var s=o[n],r=i+s,c=void 0;switch(Math.abs(s)){case 2:c=[0];break;case 1:c=[-1,0,1];break;default:c=[-2,-1,0,1,2]}for(var l,h=a(c);!(l=h()).done;){var f=l.value;e.push({cx:t+f,cy:r})}}return e},s.findAroundRange=function(t,i){for(var e=[],n=0,o=[1,0,-1];n<o.length;n++)for(var a=o[n],s=0,r=[1,0,-1];s<r.length;s++){var c=r[s];e.push({cx:t+a,cy:i+c})}return e},s.sumSurroundAttack=function(t,i){for(var e=0,n=-1;n<=1;n++)for(var o=-1;o<=1;o++)if(0!==o||0!==n){var a=t+o,s=i+n;if(this.isValidPosition(a,s)){var r=this.tilesArray[s][a];e+=this.getTileAttack(r.node)}}return e},s.getTilePosition=function(t){for(var i=0;i<this.tilesArray.length;i++)for(var e=0;e<this.tilesArray[i].length;e++)if(this.tilesArray[i][e].node===t)return{x:e,y:i};return null},s.getTileAttack=function(t){var i=t.getComponentInChildren(g);return i&&i.isMonster()?i.attack:0},s.isPositionEmpty=function(t,i){var e;return(null==(e=this.tilesArray[i])||null==(e=e[t])?void 0:e.objectType)===y.EMPTY},s.isValidPosition=function(t,i){return i>=0&&i<this.tileRows&&t>=0&&t<this.tileCols},s.instantiateObject=function(t,i,e){var n=this.objectMap.get(e);if(n){var o=this.tilesArray[i][t],a=l(n);a.setPosition(0,0),o.node.addChild(a),this.currentTiles.push(a);var s=o.node.children.indexOf(o.node.getChildByName("Mask"));e!==y.UNCOVER_JEWEL&&o.node.insertChild(a,s),e==y.DRAGON&&(o.setShow(),1==this.level&&(o.getComponentInChildren(g).attack=8,o.getComponentInChildren(g).node.getChildByName("Label-001").getComponent(p).string="8"))}else console.log("预制体不存在")},i}(u)).prototype,"tilePrefab",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=i(j.prototype,"tileSize",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 60}}),S=i(j.prototype,"objectPrefabs",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),T=i(j.prototype,"popPagePrefab",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=j))||C));s._RF.pop()}}}));

System.register("chunks:///_virtual/VictoryUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameManager.ts"],(function(t){var n,o,r,c,e;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,r=t._decorator,c=t.Component},function(t){e=t.GameManager}],execute:function(){var i;o._RF.push({},"765c5k+LD5L8b04ONqWEZvI","VictoryUI",void 0);var a=r.ccclass;r.property,t("VictoryUI",a("VictoryUI")(i=function(t){function o(){return t.apply(this,arguments)||this}return n(o,t),o.prototype.onButtonClick=function(){e.instance.transitionToPlay()},o}(c))||i);o._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});